std_err = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err,(p_2012-p_1973)-1.96*std_err)
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err,(p_2012-p_1973)-1.96*std_err)
print(sci_con_CI)
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err,(p_2012-p_1973)-1.96*std_err)
print("95% confidence interval on proportion of respondents with high science confidence (2012-1973) ):",sci_con_CI)
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err,(p_2012-p_1973)-1.96*std_err)
print(c("95% confidence interval on proportion of respondents with high science confidence (2012-1973) ):",sci_con_CI)
help print
help(print)
pooled_p = sum(sci_con$high_p) / sum(sci_con$total_resp)
sum(sci_con$high_p)
pooled_p = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
sci_con_ht = c((p_2012-p_1973)+1.96*std_err_ht,(p_2012-p_1973)-1.96*std_err_ht)
print(sci_con_CI)
help(pval)
z_score = (point_estimate - 0) / std_err_ht
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
results_table <- table(c(sci_con_CI,sci_con_pval),'Science Confidence')
results_table <- table(c(sci_con_CI,sci_con_pval))
results table
results_table
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval:",sci_con_CI))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval:",sci_con_CI[1],sci_con_cI[2])
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval:",sci_con_CI[1],sci_con_cI[2]))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval:",sci_con_CI[1],sci_con_CI[2]))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 3)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval: ",sci_con_CI[1],sci_con_CI[2]))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval: ",sci_con_CI[1],sci_con_CI[2]))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval: ",sci_con_CI[1],", ",sci_con_CI[2]))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval: ",sci_con_CI[1],", ",sci_con_CI[2]))
print(paste0("Faith in science, confidence interval: ",sci_con_CI[1],", ",sci_con_CI[2]))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = pnorm(z_score)
print(paste0("Faith in science, confidence interval: ",sci_con_CI[1],", ",sci_con_CI[2]))
print(paste0("Faith in science, p value: ",sci_con_pval))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = round(pnorm(z_score),digits = 3)
print(paste0("Faith in science, confidence interval: ",sci_con_CI[1],", ",sci_con_CI[2]))
print(paste0("Faith in science, p value: ",sci_con_pval))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_pay$year==2012,]$high_p
p_1973 = sci_con[sci_pay$year==1973,]$high_p
n_2012 = sci_con[sci_pay$year==2012,]$total_resp
n_1973 = sci_con[sci_pay$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_pay_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_pay$high_conf) / sum(sci_pay$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_pay_pval = round(pnorm(z_score),digits = 3)
print(paste0("Spend more on space program, 95% confidence interval: ",sci_pay_CI[1],", ",sci_pay_CI[2]))
print(paste0("spend more on space program, p value: ",sci_pay_pval))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_pay$year==2012,]$more_p
p_1973 = sci_con[sci_pay$year==1973,]$more_p
n_2012 = sci_con[sci_pay$year==2012,]$total_resp
n_1973 = sci_con[sci_pay$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_pay_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_pay$spend_more) / sum(sci_pay$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_pay_pval = round(pnorm(z_score),digits = 3)
print(paste0("Spend more on space program, 95% confidence interval: ",sci_pay_CI[1],", ",sci_pay_CI[2]))
print(paste0("spend more on space program, p value: ",sci_pay_pval))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_pay[sci_pay$year==2012,]$more_p
p_1973 = sci_pay[sci_pay$year==1973,]$more_p
n_2012 = sci_pay[sci_pay$year==2012,]$total_resp
n_1973 = sci_pay[sci_pay$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_pay_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_pay$spend_more) / sum(sci_pay$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_pay_pval = round(pnorm(z_score),digits = 3)
print(paste0("Spend more on space program, 95% confidence interval: ",sci_pay_CI[1],", ",sci_pay_CI[2]))
print(paste0("spend more on space program, p value: ",sci_pay_pval))
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_pay[sci_pay$year==2012,]$more_p
p_1973 = sci_pay[sci_pay$year==1973,]$more_p
n_2012 = sci_pay[sci_pay$year==2012,]$total_resp
n_1973 = sci_pay[sci_pay$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_pay_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_pay$spend_more) / sum(sci_pay$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_pay_pval = round(pnorm(z_score),digits = 3)
print(paste0("Spend more on space program, 95% confidence interval: ",sci_pay_CI[1],", ",sci_pay_CI[2]))
print(paste0("spend more on space program, p value: ",sci_pay_pval))
(p_2012*(1-p_2012))/n_2012)
(p_2012*(1-p_2012))/n_2012)
((p_2012*(1-p_2012))/n_2012)
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = round(pnorm(z_score),digits = 3)
print(paste0("Faith in science, 95% confidence interval: ",sci_con_CI[1],", ",sci_con_CI[2]))
print(paste0("Faith in science, p value: ",sci_con_pval))
#inference for question 2
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_pay[sci_pay$year==2012,]$more_p
p_1973 = sci_pay[sci_pay$year==1973,]$more_p
n_2012 = sci_pay[sci_pay$year==2012,]$total_resp
n_1973 = sci_pay[sci_pay$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/5000)+((p_1973*(1-p_1973))/5000))
sci_pay_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_pay$spend_more) / sum(sci_pay$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/p_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_pay_pval = round(pnorm(z_score),digits = 3)
print(paste0("Spend more on space program, 95% confidence interval: ",sci_pay_CI[1],", ",sci_pay_CI[2]))
print(paste0("spend more on space program, p value: ",sci_pay_pval))
(p_2012*(1-p_2012)
)
p_2012 = sci_pay[sci_pay$year==2012,]$more_p
p_1973 = sci_pay[sci_pay$year==1973,]$more_p
n_2012 = sci_pay[sci_pay$year==2012,]$total_resp
n_1973 = sci_pay[sci_pay$year==1973,]$total_resp
(p_2012*(1-p_2012)
)
(p_2012*(1-p_2012))/899
help(inference)
inference(y=natspac,x=year,data=gss,type="ci",statistic = "proportion",success="Too Little", method = "theoretical", alternative = "twosided")
inference(y=natspac,data=gss,type="ci",statistic = "proportion",success="Too Little", method = "theoretical", alternative = "twosided")
inference(y=natspac,data=gss,type="ht",statistic = "proportion",success="Too Little", method = "theoretical", alternative = "twosided")
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/p_1973))
std_err_CI = sqrt(((p_2012*(1-p_2012))/100)+((p_1973*(1-p_1973))/100))
n_2012
1/n_2012
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/100))
n_1976
n_1973
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/n_1973))
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/n_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/n_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = round(pnorm(z_score),digits = 3)
print(paste0("Faith in science, 95% confidence interval: ",sci_con_CI[1],", ",sci_con_CI[2]))
print(paste0("Faith in science, p value: ",sci_con_pval))
#inference for question 2
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_pay[sci_pay$year==2012,]$more_p
p_1973 = sci_pay[sci_pay$year==1973,]$more_p
n_2012 = sci_pay[sci_pay$year==2012,]$total_resp
n_1973 = sci_pay[sci_pay$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/n_1973))
sci_pay_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_pay$spend_more) / sum(sci_pay$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/n_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_pay_pval = round(pnorm(z_score),digits = 3)
print(paste0("Spend more on space program, 95% confidence interval: ",sci_pay_CI[1],", ",sci_pay_CI[2]))
print(paste0("spend more on space program, p value: ",sci_pay_pval))
help pnorm
help(pnorm)
#inference for question 1
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_con[sci_con$year==2012,]$high_p
p_1973 = sci_con[sci_con$year==1973,]$high_p
n_2012 = sci_con[sci_con$year==2012,]$total_resp
n_1973 = sci_con[sci_con$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/n_1973))
sci_con_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_con$high_conf) / sum(sci_con$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/n_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_con_pval = round(pnorm(z_score,lower.tail = FALSE),digits = 3)
print(paste0("Faith in science, 95% confidence interval: ",sci_con_CI[1],", ",sci_con_CI[2]))
print(paste0("Faith in science, p value: ",sci_con_pval))
#inference for question 2
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_pay[sci_pay$year==2012,]$more_p
p_1973 = sci_pay[sci_pay$year==1973,]$more_p
n_2012 = sci_pay[sci_pay$year==2012,]$total_resp
n_1973 = sci_pay[sci_pay$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/n_1973))
sci_pay_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_pay$spend_more) / sum(sci_pay$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/n_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_pay_pval = round(pnorm(z_score,lower.tail = FALSE),digits = 3)
print(paste0("Spend more on space program, 95% confidence interval: ",sci_pay_CI[1],", ",sci_pay_CI[2]))
print(paste0("spend more on space program, p value: ",sci_pay_pval))
#inference for question 2
#H_0: p_2012 - p_1973 == 0
#H_A: p_2012 - p_1973 != 0
#for confidence interval, use observe counts and proportions
p_2012 = sci_pay[sci_pay$year==2012,]$more_p
p_1973 = sci_pay[sci_pay$year==1973,]$more_p
n_2012 = sci_pay[sci_pay$year==2012,]$total_resp
n_1973 = sci_pay[sci_pay$year==1973,]$total_resp
std_err_CI = sqrt(((p_2012*(1-p_2012))/n_2012)+((p_1973*(1-p_1973))/n_1973))
sci_pay_CI =  round(c((p_2012-p_1973)+1.96*std_err_CI,(p_2012-p_1973)-1.96*std_err_CI),digits = 2)
#for hypothesis test, use expected (pooled) counts and proportions
p_pooled = sum(sci_pay$spend_more) / sum(sci_pay$total_resp)
std_err_ht = sqrt(((p_pooled*(1-p_pooled))/n_2012)+((p_pooled*(1-p_pooled))/n_1973))
point_estimate = p_2012 - p_1973
z_score = (point_estimate - 0) / std_err_ht
sci_pay_pval = round(pnorm(z_score,lower.tail = FALSE),digits = 5)
print(paste0("Spend more on space program, 95% confidence interval: ",sci_pay_CI[1],", ",sci_pay_CI[2]))
print(paste0("spend more on space program, p value: ",sci_pay_pval))
print(sci_con)
library(ggplot2)
library(dplyr)
library(statsr)
library(reshape2)
load("gss.Rdata")
summary(gss$consci)
summary(gss$natspac)
#plot trend of confidence in scientific establishment
filtered_data <- gss %>%
filter(!is.na(consci)) %>%
group_by(year)%>%
summarise(high_conf = sum(consci=="A Great Deal"), med_conf = sum(consci=="Only Some"),
low_conf =sum(consci=="Hardly Any"), total_resp = high_conf + med_conf + low_conf,
high_p = high_conf/total_resp, med_p = med_conf/total_resp, low_p = low_conf/total_resp)
sci_con <- filtered_data %>%
filter(year == 2012 | year == 1973)
dd = melt(filtered_data[,c(1,6:8)],id=c("year"))
ggplot(data=dd) + geom_line(aes(x=year,y=value,color=variable)) +
scale_colour_manual(values=c("green","blue","red"),labels =c("high confidence","medium confidence","low confidence")) +
labs(title="Confidence in science \n",y="Precent Responding")
#repeat for importance of funding space exploration
filtered_data <- gss %>%
filter(!is.na(natspac)) %>%
group_by(year)%>%
summarise(spend_more = sum(natspac=="Too Little"), spend_same = sum(natspac=="About Right"),
spend_less =sum(natspac=="Too Much"), total_resp = spend_more + spend_same + spend_less,
more_p = spend_more/total_resp, same_p = spend_same/total_resp, less_p = spend_less/total_resp)
sci_pay <- filtered_data %>%
filter(year == 2012 | year == 1973)
dd = melt(filtered_data[,c(1,6:8)],id=c("year"))
ggplot(data=dd) + geom_line(aes(x=year,y=value,color=variable)) +
scale_colour_manual(values=c("green","blue","red"),labels =c("spend more","spend same","spend less")) +
labs(title="opinion on space investment \n",y="Precent Responding")
print(sci_con)
sci_pay
summary(gss$coninc)
localPath = "C:/Users/jtm47/Documents/projects/mplx_tests/"
dataPath <- paste(localPath,"data/",sep="")
resultsPath <- paste(localPath,"results/",sep="")
srcPath <- paste(localPath,"src/",sep="")
setwd(srcPath)
lambdaPairs=rbind(c(30,20),c(50,20),c(100,20)) #setting pairs of firing rate differences for separation comparison
control.type =c("Alike", "switch", "average", "outside", "weak_switch80","weak_switch90","wt_average")
n_trials_vec=c(5,10,20,30,50) #number of trials to be simulated for each triplet
repeats = 100   #number of files(triplets) to be generated for each condition
bw=200          #Note:can not run correctly with only one bin, and total trial time must be evenly divisible by bin size
start.time=-200 #in milliseconds, used for spike generation. analysis is usually run on 500 ms of data from 0-500, but some pre-0 time is recommended
end.time=1000
source("synth_script.R")
source('~/Projects/mplx_tests/src/master_script.R', echo=TRUE)
