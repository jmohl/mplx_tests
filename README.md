## Synthetic data generation for validation of neuromplx dataset

This repo contains code needed to perform some of the sensitivity and specificity tests on our single-trial analysis of neural data (https://cran.r-project.org/web/packages/neuromplex/).

The results of this project are documented in the manuscript "Sensitivity and specificity of a Bayesian single trial analysis for time varying neural signals" published at Neurons, Behavior, Data analysis and Theory, https://arxiv.org/abs/2001.11582

### Running project
-open master_script.R and run from beginning. Options in this script include parameters for data generation as well as types of datasets to generate (matching specific hypotheses/controls described in comments, as well as below). Plotting is done via matlab script, mplx_plotting_master.m, on the final results files (labeled as [hypothesis]_poi.csv in results folder). 

-**IMPORTANT NOTE**: the initial parameters in master_script.R have been changed to produce only a small sample data set for analysis demonstration (~5 minutes computation time on desktop). In order to reproduce the full analysis (~15 hours computation time on desktop), these values should be returned those noted in commented lines 44-53.  

-Unless you want to completely rerun all analyses, I recommend editing the master_script to only evaluate the hypotheses of interest, or skipping to plotting via matlab scripts.

## Project structure
- data: stores data generated by code, for the purposes of testing
- results: contains output of poisson analysis as well as plots
- src: contains all relevant source code, including both matlab and R files. R files include a copy of the whole trial multiplexing analysis code as well as a custom script for running the code on this particular analysis (experiments_synth.R).
- doc: Not included in github repo, refer to https://arxiv.org/abs/2001.11582 for details

